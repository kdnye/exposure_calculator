<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0f172a">
  <title>FSI Expense Report Builder</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="logo">FSI</div>
    <div>
      <h1>Expense Report Builder</h1>
      <p class="tagline">Collect expenses, validate company policy, and prep the month-end packet &mdash; even offline.</p>
    </div>
  </header>

  <main>
    <section class="card">
      <h2>Report Header</h2>
      <div class="grid">
        <label>Name
          <input id="field_name" type="text" placeholder="Employee name">
        </label>
        <label>Department
          <input id="field_department" type="text" placeholder="Department or team">
        </label>
        <label>Expense Type / Focus
          <input id="field_focus" type="text" placeholder="e.g., Mileage & supplies">
        </label>
        <label>Purpose of Trip / Project
          <input id="field_purpose" type="text" placeholder="Client visit, project, etc.">
        </label>
        <label>JE Number
          <input id="field_je" type="text" placeholder="Optional journal entry #">
        </label>
        <label>Date Range
          <input id="field_dates" type="text" placeholder="e.g., Dec 4&ndash;7 2023">
        </label>
        <label>Trip Length (days)
          <input id="field_trip_length" type="number" min="0" step="1" placeholder="0">
        </label>
      </div>
    </section>

    <section class="card">
      <h2>Policy Quick Reference</h2>
      <details open>
        <summary>Travel &amp; transportation</summary>
        <ul>
          <li>Domestic airfare: book lowest available coach fare. First-class upgrades are personal expense.</li>
          <li>International airfare: business class allowed only when the published flight time is eight hours or more.</li>
          <li>Use long-term parking when away for 36+ hours. Mileage reimbursed at the current IRS rate above normal commute.</li>
          <li>Hotel gym fees reimbursable up to $15 per day.</li>
          <li>Laundry only reimbursed on trips longer than seven full days.</li>
        </ul>
      </details>
      <details>
        <summary>Meals &amp; entertainment</summary>
        <ul>
          <li>Receipts are required for all meals. Without a receipt, reimbursement caps apply: $10 breakfast, $15 lunch, $25 dinner.</li>
          <li>Only business-related entertainment where work was discussed is reimbursable.</li>
        </ul>
      </details>
      <details>
        <summary>Non-reimbursable highlights</summary>
        <ul>
          <li>First-class airfare, personal entertainment, personal grooming, and traffic fines.</li>
          <li>Airline club dues, personal sundries, and theft of personal property (unless covered by rental insurance).</li>
        </ul>
      </details>
    </section>

    <section class="card" id="expensesCard">
      <div class="card-header">
        <h2>Expenses</h2>
        <button id="addExpense" type="button">+ Add expense</button>
      </div>
      <div class="table-scroll">
        <table id="expensesTable">
          <thead>
            <tr>
              <th>Date</th>
              <th>Type</th>
              <th>Account</th>
              <th>Description / Details</th>
              <th>Payment</th>
              <th>Amount</th>
              <th>Reimbursable</th>
              <th>Policy notes</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="expensesBody"></tbody>
        </table>
      </div>
    </section>

    <section class="card" id="totalsCard">
      <h2>Totals</h2>
      <dl class="totals">
        <div>
          <dt>Total submitted</dt>
          <dd id="totalSubmitted">$0.00</dd>
        </div>
        <div>
          <dt>Due to employee</dt>
          <dd id="totalDueEmployee">$0.00</dd>
        </div>
        <div>
          <dt>Company card</dt>
          <dd id="totalCompanyCard">$0.00</dd>
        </div>
      </dl>
    </section>

    <section class="card">
      <h2>Report Preview</h2>
      <p class="hint">Snapshot updates automatically. Copy and paste into the official form.</p>
      <textarea id="reportPreview" readonly rows="10"></textarea>
      <button id="copyPreview" type="button">Copy summary</button>
      <p class="copy-feedback" id="copyFeedback" role="status" aria-live="polite"></p>
    </section>
  </main>

  <template id="expense-row-template">
    <tr class="expense-row">
      <td><input type="date" class="exp-date"></td>
      <td>
        <select class="exp-type"></select>
        <div class="detail" data-detail="meal">
          <label>Meal type
            <select class="exp-meal-type">
              <option value="breakfast">Breakfast ($10 cap w/out receipt)</option>
              <option value="lunch">Lunch ($15 cap w/out receipt)</option>
              <option value="dinner">Dinner ($25 cap w/out receipt)</option>
            </select>
          </label>
          <label class="checkbox"><input type="checkbox" class="exp-receipt" checked> Receipt provided</label>
        </div>
        <div class="detail" data-detail="mileage">
          <label>Miles driven <input type="number" min="0" step="0.1" class="exp-miles"></label>
          <p class="hint">Reimbursed at current IRS rate.</p>
        </div>
        <div class="detail" data-detail="travel">
          <label>Travel category
            <select class="exp-travel-cat">
              <option value="air_domestic">Airfare &ndash; Domestic</option>
              <option value="air_international">Airfare &ndash; International</option>
              <option value="lodging">Lodging / Hotel</option>
              <option value="parking">Parking / Tolls</option>
              <option value="ground">Ground transport (taxi, rideshare, shuttle)</option>
              <option value="laundry">Laundry / Dry cleaning</option>
              <option value="gym">Hotel gym</option>
              <option value="other">Other travel</option>
            </select>
          </label>
          <label data-flight-only>Class of service
            <select class="exp-travel-class">
              <option value="coach">Coach</option>
              <option value="premium">Premium economy</option>
              <option value="business">Business</option>
              <option value="first">First</option>
            </select>
          </label>
          <label data-flight-only>Published flight hours
            <input type="number" min="0" step="0.1" class="exp-flight-hours" placeholder="0">
          </label>
        </div>
      </td>
      <td class="expense-account">&mdash;</td>
      <td>
        <textarea class="exp-description" rows="2" placeholder="Describe the business purpose"></textarea>
      </td>
      <td>
        <select class="exp-payment">
          <option value="personal">Personal funds</option>
          <option value="company">Company card</option>
        </select>
      </td>
      <td>
        <input type="number" min="0" step="0.01" class="exp-amount" placeholder="0.00">
        <div class="detail" data-detail="mileage"><span class="mileage-rate"></span></div>
      </td>
      <td class="expense-reimbursable">$0.00</td>
      <td>
        <ul class="policy-messages"></ul>
      </td>
      <td>
        <button type="button" class="remove-expense" title="Remove">&times;</button>
      </td>
    </tr>
  </template>

  <script type="module">
    import './storage.js';
    import './app.js';
  </script>
</body>
</html>
